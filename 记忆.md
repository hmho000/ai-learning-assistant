# AI 学习助手项目记忆文档

## 项目概述
这是一个 React + Vite + TypeScript 前端项目，用于 AI 学习助手的题库系统。

## 最近的操作记录

### 2024年 - 答题模式功能实现

#### 功能描述
在题库页面新增了"答题模式"，允许用户一次性完成所有题目并提交，与原有的"练习模式"（每道题独立作答）区分开来。

#### 实现内容

1. **类型定义扩展** (`frontend/src/types/quiz.ts`)
   - 新增 `UserAnswer` 接口：用于存储用户答案
   - 新增 `QuizResult` 接口：用于存储答题结果
   - 新增 `ScoreResult` 接口：用于存储得分详情

2. **工具函数扩展** (`frontend/src/utils/quizUtils.ts`)
   - `loadQuizJsonByChapter(chapterId: number)`: 根据章节号加载 JSON 题库文件
   - `calcScore(quiz: QuizData, answers: UserAnswer[])`: 计算答题得分，返回得分、总分和每道题的详情

3. **存储功能扩展** (`frontend/src/utils/quizStorage.ts`)
   - `saveQuizResult(result)`: 保存答题结果到 localStorage，同时更新统计信息
   - 支持传入 `detail` 参数，用于更新每道题的详细统计信息（正确/错误次数等）

4. **答题模式组件** (`frontend/src/components/quiz/`)
   - `QuizExamView.tsx`: 答题模式主组件，管理所有答案状态，支持一次性提交
   - `MultipleChoiceQuestionExam.tsx`: 答题模式的选择题组件，支持 value/onChange 模式
   - `FillInBlankQuestionExam.tsx`: 答题模式的填空题组件，支持 value/onChange 模式
   - `QuizExamSummary.tsx`: 答题结果总结组件，显示得分、正确率、错题列表等

5. **页面功能扩展** (`frontend/src/pages/QuestionsPage.jsx`)
   - 新增"阅读题库"和"开始答题"两个模式切换按钮
   - 添加 `viewMode`、`quizData`、`quizLoading`、`quizError` 状态管理
   - 章节切换时自动重置模式和题库数据
   - 根据模式切换显示不同的组件（QuestionViewer 或 QuizExamView）

#### 设计原则
- **解耦合**: 答题模式组件与练习模式组件分离，各自独立维护
- **类型安全**: 使用 TypeScript 确保类型一致性
- **可维护性**: 代码结构清晰，功能模块化

#### 文件结构
```
frontend/src/
├── types/
│   └── quiz.ts                    # 类型定义（已扩展）
├── utils/
│   ├── quizUtils.ts               # 工具函数（已扩展）
│   └── quizStorage.ts             # 存储功能（已扩展）
├── components/
│   ├── quiz/
│   │   ├── QuizView.tsx           # 练习模式组件（原有）
│   │   ├── QuizExamView.tsx       # 答题模式组件（新增）
│   │   ├── MultipleChoiceQuestion.tsx      # 练习模式选择题（原有）
│   │   ├── MultipleChoiceQuestionExam.tsx  # 答题模式选择题（新增）
│   │   ├── FillInBlankQuestion.tsx         # 练习模式填空题（原有）
│   │   ├── FillInBlankQuestionExam.tsx     # 答题模式填空题（新增）
│   │   ├── QuizSummary.tsx        # 练习模式总结（原有）
│   │   └── QuizExamSummary.tsx    # 答题模式总结（新增）
│   └── QuestionViewer.jsx         # Markdown 阅读器（原有）
└── pages/
    └── QuestionsPage.jsx          # 题库页面（已扩展）
```

#### 使用说明
1. 用户在题库页面可以选择"阅读题库"或"开始答题"模式
2. 选择"开始答题"后，系统会加载对应章节的 JSON 题库文件
3. 用户可以填写所有题目，然后点击"提交答案"一次性提交
4. 提交后会显示得分、正确率和详细的答题结果
5. 答题结果会自动保存到 localStorage

#### 文档更新记录（2025年）
- ✅ 更新 README.md：将"答题交互功能"从"规划中"改为"已完成"，并添加详细功能说明
- ✅ 更新"项目功能与命令说明书.md"：
  - 添加答题模式功能说明
  - 更新前端组件结构说明
  - 添加 JSON 文件复制说明
  - 补充答题模式使用流程和数据存储说明
  - 更新文件路径速查表

#### 注意事项
- 答题模式使用 `QuizExamView` 组件，练习模式使用 `QuizView` 组件
- 两种模式的题目组件 props 接口不同，需要分别维护
- JSON 题库文件路径格式：`/questions/ch{chapterId}_questions.json`
- 题目 ID 格式：选择题为 `mc-{id}`，填空题为 `fb-{id}`

